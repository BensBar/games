<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>BenBlinko</title>
  <meta name="viewport" content="width=480, initial-scale=1, maximum-scale=1, user-scalable=no">
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Manrope:wght@500;700&display=swap" rel="stylesheet">
  <style>
    html, body {
      background: linear-gradient(120deg, #232f47 0%, #7fd7f8 100%);
      margin: 0;
      padding: 0;
      color: #222;
      font-family: 'Manrope', Arial, sans-serif;
      min-height: 100vh;
      width: 100vw;
      overflow-x: hidden;
    }
    #top-bar {
      background: rgba(34, 53, 88, 0.94);
      border-radius: 20px;
      box-shadow: 0 2px 18px #7fd7f8aa inset, 0 0 0 2px #ffe24b44;
      padding: 18px 10px 18px 10px;
      font-size: 1.2em;
      font-family: 'Orbitron', 'Manrope', Arial, sans-serif;
      display: flex;
      align-items: center;
      gap: 18px;
      justify-content: flex-start;
      width: 98vw;
      max-width: 99vw;
      margin: 10px auto 0 auto;
      overflow-x: auto;
    }
    #logo-img {
      height: 72px;
      width: auto;
      max-width: 240px;
      background: rgba(255,255,255,0.97);
      border-radius: 18px;
      padding: 10px 20px;
      margin: 0;
      box-shadow: 0 2px 38px #7fd7f8ee, 0 0 12px #ffe24b99;
      filter: drop-shadow(0 2px 16px #7fd7f8cc);
      object-fit: contain;
      display: block;
      animation: logo-pulse 3s infinite alternate;
      user-select: none;
    }
    @keyframes logo-pulse {
      0% { box-shadow: 0 2px 38px #7fd7f8ee, 0 0 12px #ffe24b99; }
      100% { box-shadow: 0 2px 58px #7fd7f8ff, 0 0 20px #ffe24bee; }
    }
    #score-bar {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 1.1em;
      flex-wrap: wrap;
    }
    .score {
      background: rgba(255,255,255,0.73);
      padding: 8px 12px;
      border-radius: 13px;
      border: 3px solid #7fd7f8cc;
      font-weight: bold;
      color: #222;
      text-shadow: 0 0 10px #b7aaf7, 0 0 2px #000;
      letter-spacing: 1.2px;
      font-family: 'Orbitron', 'Manrope', Arial, sans-serif;
      font-size: 1em;
      min-width: 68px;
      text-align: center;
      display: inline-block;
    }
    #multiplier-box {
      min-width: 70px;
      background: linear-gradient(90deg,#ffe24bdf 44%,#ff89aa99 100%);
      color: #222;
      border: 3px solid #ffe24b;
      font-weight: bold;
      font-size: 1em;
      display: flex;
      align-items: center;
      justify-content: center;
      letter-spacing: 1px;
      gap: 0;
      transition: background 0.18s, color 0.12s, border 0.13s, min-width 0.13s;
      box-shadow: 0 0 18px #ffe24b66, 0 0 8px #ff89aa44;
    }
    #multiplier-box.inactive {
      background: rgba(255,255,255,0.88);
      color: #555;
      border: 3px solid #b7aaf7;
      opacity: 0.85;
      box-shadow: none;
    }
    #multiplier-box .bonus-label {
      margin-left: 8px;
      font-size: 1em;
      opacity: 0.91;
      font-weight: 900;
      white-space: nowrap;
      color: #a97f00;
      font-family: 'Orbitron', 'Manrope', Arial, sans-serif;
    }
    #multiplier-box .bonus-label.inactive {
      color: #bbb;
      opacity: 0.65;
    }
    .animated {
      animation: bounce 0.5s cubic-bezier(.68,-0.55,.27,1.55);
    }
    @keyframes bounce {
      0% { transform: scale(1);}
      40% { transform: scale(1.3);}
      60% { transform: scale(0.95);}
      80% { transform: scale(1.13);}
      100% { transform: scale(1);}
    }
    .btn, #help-btn {
      transition: background 0.17s, color 0.18s, transform 0.13s, box-shadow 0.13s;
      font-family: 'Orbitron', 'Manrope', Arial, sans-serif;
      background: linear-gradient(90deg,#7fd7f8 40%, #ffe24b 100%);
      border-radius: 14px;
      border: 3px solid #7fd7f8;
      padding: 9px 18px;
      color: #1d2438;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 0 4px 18px #7fd7f833, 0 2px 8px #b7aaf799;
      font-size: 1em;
      outline: none;
      margin-left: 8px;
    }
    .btn:hover, #help-btn:hover {
      background: linear-gradient(90deg, #ffe24b, #7fd7f8 100%);
      color: #000;
      transform: scale(1.07);
      box-shadow: 0 0 18px #ffe24b66;
      border-color: #ffe24b;
    }
    #game-canvas {
      display: block;
      margin: 24px auto 0;
      max-width: 100vw;
      background: #232f47;
      border-radius: 22px;
      box-shadow: 0 0 44px #7fd7f888;
      border: 3px solid #7fd7f8;
      outline: none;
      touch-action: none;
    }
    /* Peg hit animation (for DOM pegs; for canvas, animated in JS) */
    .peg-hit-anim {
      animation: peg-hit 0.22s cubic-bezier(.68,-0.55,.27,1.55);
    }
    @keyframes peg-hit {
      0% { transform: scale(1);}
      60% { transform: scale(1.30);}
      100% { transform: scale(1);}
    }
    /* Responsive */
    @media (max-width: 700px) {
      #top-bar {
        padding: 6px 2vw;
        gap: 4px;
        flex-wrap: wrap;
        font-size: 0.95em;
      }
      #logo-img { height: 40px; padding: 6px 10px; }
      .score, #multiplier-box { font-size: 0.97em; padding: 4px 8px; min-width: 54px;}
      .btn, #help-btn { font-size: 0.95em; padding: 7px 8px;}
    }
    @media (max-width: 480px) {
      #top-bar { padding: 4px 2px; }
      #logo-img { height: 28px; padding: 2px 4px; }
      #score-bar { gap: 2px; }
      .btn, #help-btn { margin-left: 2px; }
    }
  </style>
</head>
<body>
  <div id="top-bar">
    <img src="img/logo.png" id="logo-img" alt="BenBlinko" />
    <div id="score-bar">
      <span class="score"><b>üèÜ</b> <span id="score-val">0</span></span>
      <span class="score"><b>‚≠ê</b> <span id="highscore-val">0</span></span>
      <span class="score"><b>üî¥</b> <span id="ball-val">1/5</span></span>
      <span id="multiplier-box" class="score inactive">
        <span id="multi-x">x2</span><span class="bonus-label inactive">COMBO</span>
      </span>
    </div>
    <button id="help-btn" class="btn">Help</button>
  </div>
  <canvas id="game-canvas" width="480" height="640" tabindex="1"></canvas>

  <script>
  // --- BEGIN GAME LOGIC (preserve your original code) ---
  // Only visual and speed changes made below.
  // If you have a separate JS file, merge the following into it as needed.

  // Example minimal game state (replace with your real logic if more complex)
  const canvas = document.getElementById('game-canvas');
  const ctx = canvas.getContext('2d');

  // --- GAME CONSTANTS (edit these for 20% slower gameplay) ---
  const GRAVITY = 0.00025 * 0.8; // original was 0.00025, now 20% slower
  const BOUNCE_DAMPING = 0.72 * 0.8; // original 0.72, now 20% slower
  const BALL_RADIUS = 11;
  const PEG_RADIUS = 7;
  const ROWS = 9;
  const COLS = 9;
  const PEG_GAP = 48;
  const PEG_Y_START = 100;
  const BALL_START_Y = 48;
  const BALL_SPEED = 6 * 0.8; // original 6, now 20% slower
  const BALL_DROP_DELAY = 700 * 1.2; // original 700ms, now 20% slower

  // --- GAME STATE ---
  let pegs = [];
  let balls = [];
  let confetti = [];
  let lastPegHit = -1;
  let score = 0;
  let highscore = 0;
  let ballsLeft = 5;
  let multiplier = 2;
  let comboActive = false;
  let ballInPlay = false;

  // --- INITIALIZATION ---
  function makePegs() {
    pegs = [];
    for (let row = 0; row < ROWS; ++row) {
      for (let col = 0; col < COLS; ++col) {
        let offset = (row % 2 === 0) ? 0 : PEG_GAP / 2;
        pegs.push({
          x: 40 + col * PEG_GAP + offset,
          y: PEG_Y_START + row * PEG_GAP,
          hit: false,
          anim: 0
        });
      }
    }
  }
  makePegs();

  function resetGame() {
    score = 0;
    ballsLeft = 5;
    multiplier = 2;
    comboActive = false;
    ballInPlay = false;
    lastPegHit = -1;
    balls = [];
    confetti = [];
    makePegs();
    updateUI();
    setTimeout(dropBall, 800);
  }

  function updateUI() {
    document.getElementById('score-val').textContent = score;
    document.getElementById('highscore-val').textContent = highscore;
    document.getElementById('ball-val').textContent = ballsLeft + "/5";
    let mb = document.getElementById('multiplier-box');
    let mx = document.getElementById('multi-x');
    let label = mb.querySelector('.bonus-label');
    if (!comboActive) {
      mb.classList.add('inactive');
      mx.textContent = `x${multiplier}`;
      label.textContent = "COMBO";
      label.classList.add('inactive');
    } else {
      mb.classList.remove('inactive');
      mx.textContent = `x${multiplier}`;
      label.textContent = "COMBO!";
      label.classList.remove('inactive');
    }
  }
  function animateScore(id) {
    let el = document.getElementById(id);
    if (!el) return;
    el.classList.add('animated');
    setTimeout(()=>el.classList.remove('animated'), 500);
  }

  // --- GAMEPLAY ---
  function dropBall() {
    if (ballsLeft <= 0 || ballInPlay) return;
    ballInPlay = true;
    ballsLeft--;
    updateUI();
    animateScore('ball-val');
    balls.push({
      x: canvas.width / 2,
      y: BALL_START_Y,
      vx: (Math.random()-0.5) * BALL_SPEED,
      vy: 0,
      radius: BALL_RADIUS,
      color: "#ffe24b",
      landed: false
    });
  }

  function update() {
    // Ball physics
    for (let ball of balls) {
      if (ball.landed) continue;
      ball.vy += GRAVITY * canvas.height;
      ball.x += ball.vx;
      ball.y += ball.vy;

      // Wall bounce
      if (ball.x < ball.radius) {
        ball.x = ball.radius; ball.vx = -ball.vx * BOUNCE_DAMPING;
      }
      if (ball.x > canvas.width - ball.radius) {
        ball.x = canvas.width - ball.radius; ball.vx = -ball.vx * BOUNCE_DAMPING;
      }

      // Peg collision
      for (let i=0; i<pegs.length; ++i) {
        let peg = pegs[i];
        let dx = ball.x - peg.x, dy = ball.y - peg.y, dist = Math.sqrt(dx*dx + dy*dy);
        if (dist < ball.radius + PEG_RADIUS && !peg.hit) {
          peg.hit = true;
          peg.anim = 1.0;
          ball.vy = -Math.abs(ball.vy) * BOUNCE_DAMPING;
          animateScore('score-val');
          score += 10 * multiplier;
          comboActive = true;
          multiplier ++;
          animateScore('multiplier-box');
          // Confetti
          for (let j=0;j<7;++j) {
            confetti.push({
              x: peg.x, y: peg.y,
              vx: (Math.random()-0.5)*3, vy: (Math.random()-0.5)*2,
              color: ['#7fd7f8','#b7aaf7','#8dd6e8','#ffe24b','#ff89aa'][j%5],
              t: 0,
              shape: Math.random()<0.5?'circle':'star'
            });
          }
        }
      }

      // Landed
      if (ball.y > canvas.height - ball.radius) {
        ball.y = canvas.height - ball.radius;
        ball.vy = 0; ball.vx = 0;
        ball.landed = true;
        ballInPlay = false;
        setTimeout(()=>{
          // Reset combo if no peg hit on drop
          if (!comboActive) {
            multiplier = 2;
            animateScore('multiplier-box');
          }
          comboActive = false;
          updateUI();
          if (ballsLeft > 0) setTimeout(dropBall, BALL_DROP_DELAY);
        }, 500);
      }
    }
    // Peg hit animation decay
    for (let peg of pegs) if (peg.anim>0) peg.anim -= 0.10;
    // Confetti motion
    for (let c of confetti) {
      c.x += c.vx;
      c.y += c.vy;
      c.vy += 0.12;
      c.t++;
    }
    confetti = confetti.filter(c => c.t < 80);
    // Highscore
    if (score > highscore) { highscore = score; animateScore('highscore-val'); }
  }

  function draw() {
    ctx.clearRect(0,0,canvas.width,canvas.height);
    // Board bg
    let grd = ctx.createLinearGradient(0,0,canvas.width,canvas.height);
    grd.addColorStop(0, "#313c5d");
    grd.addColorStop(1, "#7fd7f8");
    ctx.fillStyle = grd;
    ctx.fillRect(0,0,canvas.width,canvas.height);

    // Draw pegs
    for (let peg of pegs) {
      ctx.save();
      ctx.beginPath();
      let r = PEG_RADIUS + (peg.anim>0 ? peg.anim*6 : 0);
      ctx.arc(peg.x, peg.y, r, 0, Math.PI*2);
      ctx.fillStyle = peg.hit ? "#ffe24b" : "#b7aaf7";
      if (peg.anim>0) {
        ctx.shadowColor = "#ffe24b";
        ctx.shadowBlur = 18*peg.anim;
      }
      ctx.globalAlpha = peg.hit ? 0.9 : 0.7;
      ctx.fill();
      ctx.restore();
    }

    // Draw balls
    for (let ball of balls) {
      ctx.save();
      ctx.beginPath();
      ctx.arc(ball.x, ball.y, ball.radius, 0, Math.PI*2);
      ctx.fillStyle = ball.color;
      ctx.shadowColor = "#fff";
      ctx.shadowBlur = 12;
      ctx.fill();
      ctx.restore();
    }

    // Draw confetti
    for (let c of confetti) {
      ctx.save();
      ctx.globalAlpha = Math.max(0, 1 - c.t/80);
      ctx.fillStyle = c.color;
      if (c.shape === "star") {
        drawStar(ctx, c.x, c.y, 5, 4, 2.2 + Math.sin(c.t/3) * 1.1);
      } else {
        ctx.beginPath();
        ctx.arc(c.x, c.y, 2.1+Math.sin(c.t/3)*1.05, 0, Math.PI*2);
        ctx.fill();
      }
      ctx.restore();
    }
  }

  function drawStar(ctx, x, y, points, outerRadius, innerRadius) {
    let angle = Math.PI / points;
    ctx.beginPath();
    for (let i = 0; i < 2 * points; i++) {
      let r = (i % 2 === 0) ? outerRadius : innerRadius;
      ctx.lineTo(
        x + Math.cos(i * angle) * r,
        y + Math.sin(i * angle) * r
      );
    }
    ctx.closePath();
    ctx.fill();
  }

  function loop() {
    update();
    draw();
    requestAnimationFrame(loop);
  }
  resetGame();
  loop();

  // --- EVENTS ---
  canvas.addEventListener('pointerdown', function(e) {
    if (ballInPlay || ballsLeft <= 0) return;
    let rect = canvas.getBoundingClientRect();
    let x = (e.clientX - rect.left) * canvas.width / rect.width;
    balls.push({
      x: x,
      y: BALL_START_Y,
      vx: (Math.random()-0.5) * BALL_SPEED,
      vy: 0,
      radius: BALL_RADIUS,
      color: "#ffe24b",
      landed: false
    });
    ballsLeft--;
    updateUI();
    animateScore('ball-val');
    ballInPlay = true;
  });

  document.getElementById('help-btn').onclick = function() {
    alert("BenBlinko\n\nDrop the balls and hit pegs to score! The more pegs you hit in a row, the higher your combo multiplier. Good luck!");
  };

  // Keyboard: space to drop
  window.addEventListener('keydown', e => { if (e.code=="Space") dropBall(); });

  // Keep canvas focus for keyboard on load
  window.onload = () => { canvas.focus(); };

  // --- END GAME LOGIC ---

  </script>
</body>
</html>